<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TcpClient2: Client Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="classes.html"><span>Class&nbsp;Index</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>Client Class Reference</h1><!-- doxytag: class="Client" -->
<p><a class="el" href="classClient.html" title="Client class.">Client</a> class.  
<a href="#_details">More...</a></p>

<p><a href="classClient-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">TC2API void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classClient.html#ac1b8a1bcc592b90be708f53c6f3379c8">client_closeConnection</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Closes the connection.  <a href="#ac1b8a1bcc592b90be708f53c6f3379c8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">TC2API <a class="el" href="config_8h.html#a6e2560c92901098cb3cd008a79dcdeba">bool</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classClient.html#ab47c0c9a394979f9a438f0f57598b53c">client_connect</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Tries to connect with the server.  <a href="#ab47c0c9a394979f9a438f0f57598b53c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">TC2API <a class="el" href="config_8h.html#a6e2560c92901098cb3cd008a79dcdeba">bool</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classClient.html#a59e06c6b46755936dc38237c8d2c4598">client_connectionClosed</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Tells if the connection has been closed right after an operation (send/receive) ends in error.  <a href="#a59e06c6b46755936dc38237c8d2c4598"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">TC2API void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classClient.html#a2cb4ba780f0333535bccaf7c179909ab">client_createClientSocket</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Creates the client socket.  <a href="#a2cb4ba780f0333535bccaf7c179909ab"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">TC2API <a class="el" href="config_8h.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classClient.html#a7b91cbaab1c8ebdaa38caed1f50b050a">client_error</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Retrieves the value of the error that occurred immediately after a socket operation.  <a href="#a7b91cbaab1c8ebdaa38caed1f50b050a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">TC2API <a class="el" href="config_8h.html#ab95f123a6c9bcfee6a343170ef8c5f69">ushort</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classClient.html#a800b9dc4b73f58fa14a0f124f143f2d5">client_errorType</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Retrieves the type of the error that occurred immediately after a socket operation.  <a href="#a800b9dc4b73f58fa14a0f124f143f2d5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">TC2API <a class="el" href="config_8h.html#a6e2560c92901098cb3cd008a79dcdeba">bool</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classClient.html#a802927ed10beeb0aa3034baba21abf14">client_formatError</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Reports if there has been a format error on the wire right after a receive operation.  <a href="#a802927ed10beeb0aa3034baba21abf14"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">TC2API void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classClient.html#a1b7cef854eb0b6febc2f315def5e4c22">client_init</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initializes the <a class="el" href="classClient.html" title="Client class.">Client</a> façade class.  <a href="#a1b7cef854eb0b6febc2f315def5e4c22"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">TC2API <a class="el" href="config_8h.html#a6e2560c92901098cb3cd008a79dcdeba">bool</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classClient.html#a01fe6e28b2b7463eb375bfd2c31a316b">client_isConnected</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Checks if the client is connected to the server.  <a href="#a01fe6e28b2b7463eb375bfd2c31a316b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">TC2API <a class="el" href="config_8h.html#a6e2560c92901098cb3cd008a79dcdeba">bool</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classClient.html#a21671dd01411a1478cc6d2ad4eeba468">client_recvMessage</a> (<a class="el" href="structMessage.html">Message</a> *msg)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Receives a message from the server.  <a href="#a21671dd01411a1478cc6d2ad4eeba468"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">TC2API <a class="el" href="config_8h.html#a6e2560c92901098cb3cd008a79dcdeba">bool</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classClient.html#ad12e0cdab8fa5ba7aa64865ec0b23b38">client_sendMessage</a> (<a class="el" href="structMessage.html">Message</a> *msg)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Tries to send a message to the server.  <a href="#ad12e0cdab8fa5ba7aa64865ec0b23b38"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">TC2API void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classClient.html#aff7978dd9e2e6d96ac19e377a18616e5">client_setReplyTimeout</a> (<a class="el" href="config_8h.html#ab95f123a6c9bcfee6a343170ef8c5f69">ushort</a> seconds)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Configures how many seconds to wait for a reply from the server.  <a href="#aff7978dd9e2e6d96ac19e377a18616e5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">TC2API void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classClient.html#af468f4e75580ec6ab7a8abd967183032">client_setServerAddress</a> (<a class="el" href="config_8h.html#a0f128c3e0c83721af0220c00554e9c4e">cchar</a> *ipAddress)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Configures the server IP address.  <a href="#af468f4e75580ec6ab7a8abd967183032"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">TC2API void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classClient.html#a3358a12decc93d997ef2a27110173a01">client_setServicePort</a> (<a class="el" href="config_8h.html#ab95f123a6c9bcfee6a343170ef8c5f69">ushort</a> port)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Configures the server TCP port.  <a href="#a3358a12decc93d997ef2a27110173a01"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">TC2API void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classClient.html#a46c987e1550f39b919ea87969ac08f9e">client_setTrace</a> (<a class="el" href="config_8h.html#a6e2560c92901098cb3cd008a79dcdeba">bool</a> flag)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Enables or disables tracing.  <a href="#a46c987e1550f39b919ea87969ac08f9e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">TC2API <a class="el" href="config_8h.html#a6e2560c92901098cb3cd008a79dcdeba">bool</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classClient.html#abd9d963db56bc1578cb78c5db866c786">client_timeout</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Reports if there has been a timeout after a receive operations ends in error.  <a href="#abd9d963db56bc1578cb78c5db866c786"></a><br/></td></tr>
<tr><td colspan="2"><h2>Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classClient.html#ac1a0ff1d1c2453cc22c028da29fcb115">recvBuffer</a> (int socket, char *buf, int len, unsigned nSeconds, <a class="el" href="config_8h.html#a6e2560c92901098cb3cd008a79dcdeba">bool</a> firstPart)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Receives a specific-length buffer from peer application, and checks for error.  <a href="#ac1a0ff1d1c2453cc22c028da29fcb115"></a><br/></td></tr>
<tr><td colspan="2"><h2>Static Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="config_8h.html#a0f128c3e0c83721af0220c00554e9c4e">cchar</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classClient.html#a7e2c66ccc38864c00befd65cefa28c00">sourceID</a> [] = &quot;ZCL&quot;</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Identification for the <a class="el" href="classLog.html" title="Log class.">Log</a> file.  <a href="#a7e2c66ccc38864c00befd65cefa28c00"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="config_8h.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classClient.html#a258ded446f21a1edd363ab196974c202">orgSeqNo</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Global counter used when sending messages.  <a href="#a258ded446f21a1edd363ab196974c202"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="config_8h.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classClient.html#a6dee50ddcd3fa9bd16c33ea160d15ae6">serverAddress</a> = 0x7F000001</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Default server IP address in binary (127.1).  <a href="#a6dee50ddcd3fa9bd16c33ea160d15ae6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classClient.html#ab60a34da8654480c6bba7ac1df2da8c3">serverAddressStr</a> [50] = &quot;127.1&quot;</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Default server IP address as string.  <a href="#ab60a34da8654480c6bba7ac1df2da8c3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="config_8h.html#ab95f123a6c9bcfee6a343170ef8c5f69">ushort</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classClient.html#ac289967d57409c9bfe8d380f777bca9e">servicePort</a> = 4000</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Default server TCP port.  <a href="#ac289967d57409c9bfe8d380f777bca9e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classClient.html#adc5475d507e3d713ad405bbeb6eb41e7">clientSocket</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The client socket.  <a href="#adc5475d507e3d713ad405bbeb6eb41e7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="config_8h.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classClient.html#a337c42b5e32a1f92420bd21afa6c1f85">replyTimeout</a> = ((<a class="el" href="config_8h.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>)-1)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Default server reply timeout in seconds.  <a href="#a337c42b5e32a1f92420bd21afa6c1f85"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="config_8h.html#ab95f123a6c9bcfee6a343170ef8c5f69">ushort</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classClient.html#ac6ebab6dbd29d69c58e999ec0273f074">sendTimeout</a> = 5</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Default timeout in seconds when sending a message to the server.  <a href="#ac6ebab6dbd29d69c58e999ec0273f074"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="config_8h.html#a6e2560c92901098cb3cd008a79dcdeba">bool</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classClient.html#ada1a895a5ff67fb36ed9a4765f2274d2">isConnected</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">State of the connection.  <a href="#ada1a895a5ff67fb36ed9a4765f2274d2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="config_8h.html#a6e2560c92901098cb3cd008a79dcdeba">bool</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classClient.html#ad3973a11a1a20211111f43cb17b5ee31">connectionClosed</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Tells if the connection has been closed after an operation end in error.  <a href="#ad3973a11a1a20211111f43cb17b5ee31"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="config_8h.html#a6e2560c92901098cb3cd008a79dcdeba">bool</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classClient.html#ada0babaa8c1187b1c28fac649bb6ecef">formatError</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Tells if there has been a format error on the wire right after a receive operation.  <a href="#ada0babaa8c1187b1c28fac649bb6ecef"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classClient.html#ab825728c14e12d04922f751c3f67cb0a">lastSocketError</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Contains the number of the error that occurred immediately after a socket operation.  <a href="#ab825728c14e12d04922f751c3f67cb0a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classClient.html#ab8d2b8c93dc01b7a6ff54c8a06198302">lastErrorType</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Contains the type of the error that occurred immediately after a socket operation.  <a href="#ab8d2b8c93dc01b7a6ff54c8a06198302"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="config_8h.html#a6e2560c92901098cb3cd008a79dcdeba">bool</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classClient.html#ae6e3c294a22e2bdcc8a4893e193ce7d3">timeoutOccurred</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Tells id there has been a timeout after a receive operations ends in error.  <a href="#ae6e3c294a22e2bdcc8a4893e193ce7d3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="config_8h.html#a6e2560c92901098cb3cd008a79dcdeba">bool</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classClient.html#aede8ee1d904b3abd665f17607902ed4a">isTracing</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Tells if tracing is enabled.  <a href="#aede8ee1d904b3abd665f17607902ed4a"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p><a class="el" href="classClient.html" title="Client class.">Client</a> class. </p>
<p>This class provides convenience members and methods to write simple client applications. </p>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="ac1b8a1bcc592b90be708f53c6f3379c8"></a><!-- doxytag: member="Client::client_closeConnection" ref="ac1b8a1bcc592b90be708f53c6f3379c8" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TC2API void client_closeConnection </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Closes the connection. </p>

<p>Definition at line <a class="el" href="Client_8c_source.html#l00384">384</a> of file <a class="el" href="Client_8c_source.html">Client.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00385"></a>00385 {
<a name="l00386"></a>00386    <a class="code" href="Log_8h.html#aba64819ead3a2defc230ec7ccf655c4e" title="standard source file name for inclusion in log">log_func</a>(<a class="code" href="classClient.html#ac1b8a1bcc592b90be708f53c6f3379c8" title="Closes the connection.">client_closeConnection</a>);
<a name="l00387"></a>00387    <a class="code" href="Log_8h.html#a619ac1ab71ab5d1c7e94e03ddbf16d3b" title="log informational record with function identification (see Log::log_fheader)">log_finfo</a>(<span class="stringliteral">&quot;closing the connection with the server&quot;</span>);
<a name="l00388"></a>00388 
<a name="l00389"></a>00389    socket_close(<a class="code" href="classClient.html#adc5475d507e3d713ad405bbeb6eb41e7" title="The client socket.">clientSocket</a>);
<a name="l00390"></a>00390    <a class="code" href="classClient.html#ada1a895a5ff67fb36ed9a4765f2274d2" title="State of the connection.">isConnected</a> = <span class="keyword">false</span>;
<a name="l00391"></a>00391 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ab47c0c9a394979f9a438f0f57598b53c"></a><!-- doxytag: member="Client::client_connect" ref="ab47c0c9a394979f9a438f0f57598b53c" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TC2API <a class="el" href="config_8h.html#a6e2560c92901098cb3cd008a79dcdeba">bool</a> client_connect </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Tries to connect with the server. </p>

<p>Definition at line <a class="el" href="Client_8c_source.html#l00402">402</a> of file <a class="el" href="Client_8c_source.html">Client.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00403"></a>00403 {
<a name="l00404"></a>00404    <a class="code" href="Log_8h.html#aba64819ead3a2defc230ec7ccf655c4e" title="standard source file name for inclusion in log">log_func</a>(<a class="code" href="classClient.html#ab47c0c9a394979f9a438f0f57598b53c" title="Tries to connect with the server.">client_connect</a>);
<a name="l00405"></a>00405    <a class="code" href="Log_8h.html#a619ac1ab71ab5d1c7e94e03ddbf16d3b" title="log informational record with function identification (see Log::log_fheader)">log_finfo</a>(<span class="stringliteral">&quot;trying to connect with the server %s&quot;</span>, <a class="code" href="classClient.html#ab60a34da8654480c6bba7ac1df2da8c3" title="Default server IP address as string.">serverAddressStr</a>);
<a name="l00406"></a>00406 
<a name="l00407"></a>00407    <a class="code" href="classClient.html#ada1a895a5ff67fb36ed9a4765f2274d2" title="State of the connection.">isConnected</a> = <span class="keyword">false</span>;
<a name="l00408"></a>00408 
<a name="l00409"></a>00409    <span class="keywordflow">if</span> (<a class="code" href="Socket_8h.html#a1df57f497a7936c9b3d414c08358f425" title="see Socket::socket_connect">socket_connect</a>(<a class="code" href="classClient.html#adc5475d507e3d713ad405bbeb6eb41e7" title="The client socket.">clientSocket</a>, <a class="code" href="classClient.html#a6dee50ddcd3fa9bd16c33ea160d15ae6" title="Default server IP address in binary (127.1).">serverAddress</a>, <a class="code" href="classClient.html#ac289967d57409c9bfe8d380f777bca9e" title="Default server TCP port.">servicePort</a>))
<a name="l00410"></a>00410    {
<a name="l00411"></a>00411       <a class="code" href="Log_8h.html#a619ac1ab71ab5d1c7e94e03ddbf16d3b" title="log informational record with function identification (see Log::log_fheader)">log_finfo</a>(<span class="stringliteral">&quot;ok, connection successful&quot;</span>);
<a name="l00412"></a>00412       <a class="code" href="classClient.html#ada1a895a5ff67fb36ed9a4765f2274d2" title="State of the connection.">isConnected</a> = <span class="keyword">true</span>;
<a name="l00413"></a>00413       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00414"></a>00414    }
<a name="l00415"></a>00415 
<a name="l00416"></a>00416    <a class="code" href="classClient.html#ab825728c14e12d04922f751c3f67cb0a" title="Contains the number of the error that occurred immediately after a socket operation...">lastSocketError</a> = socket_error();
<a name="l00417"></a>00417 
<a name="l00418"></a>00418    <a class="code" href="Log_8h.html#aa62b9042f25fb0b8205e108ed438a1a6" title="log error record with function identification (see Log::log_fheader)">log_ferror</a>(<span class="stringliteral">&quot;error %d trying to connect with the server&quot;</span>, <a class="code" href="classClient.html#ab825728c14e12d04922f751c3f67cb0a" title="Contains the number of the error that occurred immediately after a socket operation...">lastSocketError</a>);
<a name="l00419"></a>00419    <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00420"></a>00420 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a59e06c6b46755936dc38237c8d2c4598"></a><!-- doxytag: member="Client::client_connectionClosed" ref="a59e06c6b46755936dc38237c8d2c4598" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TC2API <a class="el" href="config_8h.html#a6e2560c92901098cb3cd008a79dcdeba">bool</a> client_connectionClosed </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Tells if the connection has been closed right after an operation (send/receive) ends in error. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>true (connection has been closed) / false (connection has not been closed) </dd></dl>

<p>Definition at line <a class="el" href="Client_8c_source.html#l00435">435</a> of file <a class="el" href="Client_8c_source.html">Client.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00436"></a>00436 {
<a name="l00437"></a>00437    <span class="keywordflow">return</span> <a class="code" href="classClient.html#ad3973a11a1a20211111f43cb17b5ee31" title="Tells if the connection has been closed after an operation end in error.">connectionClosed</a>;
<a name="l00438"></a>00438 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2cb4ba780f0333535bccaf7c179909ab"></a><!-- doxytag: member="Client::client_createClientSocket" ref="a2cb4ba780f0333535bccaf7c179909ab" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TC2API void client_createClientSocket </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Creates the client socket. </p>
<dl class="post"><dt><b>Postcondition:</b></dt><dd>either succeeds or aborts the application </dd></dl>

<p>Definition at line <a class="el" href="Client_8c_source.html#l00452">452</a> of file <a class="el" href="Client_8c_source.html">Client.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00453"></a>00453 {
<a name="l00454"></a>00454    <a class="code" href="Log_8h.html#aba64819ead3a2defc230ec7ccf655c4e" title="standard source file name for inclusion in log">log_func</a>(<a class="code" href="classClient.html#a2cb4ba780f0333535bccaf7c179909ab" title="Creates the client socket.">client_createClientSocket</a>);
<a name="l00455"></a>00455    <a class="code" href="Log_8h.html#a619ac1ab71ab5d1c7e94e03ddbf16d3b" title="log informational record with function identification (see Log::log_fheader)">log_finfo</a>(<span class="stringliteral">&quot;creating the client socket&quot;</span>);
<a name="l00456"></a>00456 
<a name="l00457"></a>00457    <a class="code" href="classClient.html#adc5475d507e3d713ad405bbeb6eb41e7" title="The client socket.">clientSocket</a> = <a class="code" href="Socket_8h.html#a626d07f2d347c9695c03ee56d5abae57" title="see Socket::socket_createClientSocket">socket_createClientSocket</a>();
<a name="l00458"></a>00458 
<a name="l00459"></a>00459 <span class="comment">// don&#39;t do it for now </span>
<a name="l00460"></a>00460 <span class="comment">// socket_setNonBlocking(clientSocket);</span>
<a name="l00461"></a>00461 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7b91cbaab1c8ebdaa38caed1f50b050a"></a><!-- doxytag: member="Client::client_error" ref="a7b91cbaab1c8ebdaa38caed1f50b050a" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TC2API <a class="el" href="config_8h.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> client_error </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Retrieves the value of the error that occurred immediately after a socket operation. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>number of error that occurred immediately after a socket operation </dd></dl>

<p>Definition at line <a class="el" href="Client_8c_source.html#l00476">476</a> of file <a class="el" href="Client_8c_source.html">Client.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00477"></a>00477 {
<a name="l00478"></a>00478    <span class="keywordflow">return</span> <a class="code" href="classClient.html#ab825728c14e12d04922f751c3f67cb0a" title="Contains the number of the error that occurred immediately after a socket operation...">lastSocketError</a>;
<a name="l00479"></a>00479 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a800b9dc4b73f58fa14a0f124f143f2d5"></a><!-- doxytag: member="Client::client_errorType" ref="a800b9dc4b73f58fa14a0f124f143f2d5" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TC2API <a class="el" href="config_8h.html#ab95f123a6c9bcfee6a343170ef8c5f69">ushort</a> client_errorType </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Retrieves the type of the error that occurred immediately after a socket operation. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>type of the error (only for use of the class <a class="el" href="structGenericClient.html" title="GenericClient class.">GenericClient</a>) </dd></dl>

<p>Definition at line <a class="el" href="Client_8c_source.html#l00494">494</a> of file <a class="el" href="Client_8c_source.html">Client.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00495"></a>00495 {
<a name="l00496"></a>00496    <span class="keywordflow">return</span> <a class="code" href="classClient.html#ab8d2b8c93dc01b7a6ff54c8a06198302" title="Contains the type of the error that occurred immediately after a socket operation...">lastErrorType</a>;
<a name="l00497"></a>00497 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a802927ed10beeb0aa3034baba21abf14"></a><!-- doxytag: member="Client::client_formatError" ref="a802927ed10beeb0aa3034baba21abf14" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TC2API <a class="el" href="config_8h.html#a6e2560c92901098cb3cd008a79dcdeba">bool</a> client_formatError </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reports if there has been a format error on the wire right after a receive operation. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>true (a format error occurred) / false (a format error not occurred) </dd></dl>

<p>Definition at line <a class="el" href="Client_8c_source.html#l00512">512</a> of file <a class="el" href="Client_8c_source.html">Client.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00513"></a>00513 {
<a name="l00514"></a>00514    <span class="keywordflow">return</span> <a class="code" href="classClient.html#ada0babaa8c1187b1c28fac649bb6ecef" title="Tells if there has been a format error on the wire right after a receive operation...">formatError</a>;
<a name="l00515"></a>00515 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1b7cef854eb0b6febc2f315def5e4c22"></a><!-- doxytag: member="Client::client_init" ref="a1b7cef854eb0b6febc2f315def5e4c22" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TC2API void client_init </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initializes the <a class="el" href="classClient.html" title="Client class.">Client</a> façade class. </p>

<p>Definition at line <a class="el" href="Client_8c_source.html#l00526">526</a> of file <a class="el" href="Client_8c_source.html">Client.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00527"></a>00527 {
<a name="l00528"></a>00528    <a class="code" href="Log_8h.html#aba64819ead3a2defc230ec7ccf655c4e" title="standard source file name for inclusion in log">log_func</a>(<a class="code" href="classClient.html#a1b7cef854eb0b6febc2f315def5e4c22" title="Initializes the Client façade class.">client_init</a>);
<a name="l00529"></a>00529    <a class="code" href="Log_8h.html#a619ac1ab71ab5d1c7e94e03ddbf16d3b" title="log informational record with function identification (see Log::log_fheader)">log_finfo</a>(<span class="stringliteral">&quot;Client class inicialization&quot;</span>);
<a name="l00530"></a>00530 
<a name="l00531"></a>00531    <a class="code" href="Socket_8h.html#a7efcc50c2ab1379d0eb6e9bcbceeb1fd" title="see Socket::socket_init">socket_init</a>();
<a name="l00532"></a>00532 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a01fe6e28b2b7463eb375bfd2c31a316b"></a><!-- doxytag: member="Client::client_isConnected" ref="a01fe6e28b2b7463eb375bfd2c31a316b" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TC2API <a class="el" href="config_8h.html#a6e2560c92901098cb3cd008a79dcdeba">bool</a> client_isConnected </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Checks if the client is connected to the server. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>true (is connected) / false (is not connected) </dd></dl>

<p>Definition at line <a class="el" href="Client_8c_source.html#l00546">546</a> of file <a class="el" href="Client_8c_source.html">Client.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00547"></a>00547 {
<a name="l00548"></a>00548    <span class="keywordflow">return</span> <a class="code" href="classClient.html#ada1a895a5ff67fb36ed9a4765f2274d2" title="State of the connection.">isConnected</a>;
<a name="l00549"></a>00549 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a21671dd01411a1478cc6d2ad4eeba468"></a><!-- doxytag: member="Client::client_recvMessage" ref="a21671dd01411a1478cc6d2ad4eeba468" args="(Message *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TC2API <a class="el" href="config_8h.html#a6e2560c92901098cb3cd008a79dcdeba">bool</a> client_recvMessage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMessage.html">Message</a> *&nbsp;</td>
          <td class="paramname"> <em>msg</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Receives a message from the server. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>msg</em>&nbsp;</td><td>: address of a <a class="el" href="structMessage.html" title="Message data structure.">Message</a> structure which will be used to store data received from the server</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>true (reception successful) / false (reception failure) </dd></dl>

<p></p>

<p>Definition at line <a class="el" href="Client_8c_source.html#l00567">567</a> of file <a class="el" href="Client_8c_source.html">Client.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00568"></a>00568 {
<a name="l00569"></a>00569    <span class="keywordtype">int</span> ret;
<a name="l00570"></a>00570    <a class="code" href="structTimeout.html" title="Structure representing timeout.">Timeout</a> timeout;
<a name="l00571"></a>00571    <a class="code" href="Log_8h.html#aba64819ead3a2defc230ec7ccf655c4e" title="standard source file name for inclusion in log">log_func</a>(<a class="code" href="classClient.html#a21671dd01411a1478cc6d2ad4eeba468" title="Receives a message from the server.">client_recvMessage</a>);
<a name="l00572"></a>00572    <span class="keyword">static</span> <a class="code" href="config_8h.html#a0f128c3e0c83721af0220c00554e9c4e" title="const char abbreviation">cchar</a> msgclose[] = <span class="stringliteral">&quot;now closing connection&quot;</span>;
<a name="l00573"></a>00573 <span class="comment"></span>
<a name="l00574"></a>00574 <span class="comment">   /// @cond hides_from_doxygen</span>
<a name="l00575"></a>00575 <span class="comment"></span><span class="preprocessor">   #define REM_TIME timeout_remaining(&amp;timeout)</span>
<a name="l00576"></a>00576 <span class="preprocessor"></span><span class="comment">   /// @endcond</span>
<a name="l00577"></a>00577 <span class="comment"></span>
<a name="l00578"></a>00578    assert(msg);
<a name="l00579"></a>00579 
<a name="l00580"></a>00580    <a class="code" href="Timeout_8h.html#ad8599e1fdfec0ba14e3f4f415765d60c" title="see Timeout::timeout_init">timeout_init</a>(&amp;timeout, <a class="code" href="classClient.html#a337c42b5e32a1f92420bd21afa6c1f85" title="Default server reply timeout in seconds.">replyTimeout</a>);
<a name="l00581"></a>00581 
<a name="l00582"></a>00582    <span class="comment">// tries to receive the message&#39;s first part</span>
<a name="l00583"></a>00583    <a class="code" href="Log_8h.html#ab4478c2e145cf2707099a4676a81a2d6" title="log debug record with function identification (see Log::log_fheader)">log_fdebug</a>(<span class="stringliteral">&quot;trying to receive %d bytes (first part of message)&quot;</span>,
<a name="l00584"></a>00584       <a class="code" href="Message_8h.html#ab2c30f86b55850b3e0859fc37b9e6aa1" title="see Message::message_size1">message_size1</a>());
<a name="l00585"></a>00585 
<a name="l00586"></a>00586    ret = <a class="code" href="classClient.html#ac1a0ff1d1c2453cc22c028da29fcb115" title="Receives a specific-length buffer from peer application, and checks for error.">recvBuffer</a>(<a class="code" href="classClient.html#adc5475d507e3d713ad405bbeb6eb41e7" title="The client socket.">clientSocket</a>, <a class="code" href="Message_8h.html#abd75d5c27798093d703c092bbaf40ef2" title="see Message::message_start">message_start</a>(msg), <a class="code" href="Message_8h.html#ab2c30f86b55850b3e0859fc37b9e6aa1" title="see Message::message_size1">message_size1</a>(),
<a name="l00587"></a>00587       REM_TIME, <span class="keyword">true</span> <span class="comment">/*first part of message*/</span>);
<a name="l00588"></a>00588 
<a name="l00589"></a>00589    <span class="keywordflow">if</span> (ret != (<span class="keywordtype">int</span>)<a class="code" href="Message_8h.html#ab2c30f86b55850b3e0859fc37b9e6aa1" title="see Message::message_size1">message_size1</a>())
<a name="l00590"></a>00590    {
<a name="l00591"></a>00591       <a class="code" href="Log_8h.html#aa62b9042f25fb0b8205e108ed438a1a6" title="log error record with function identification (see Log::log_fheader)">log_ferror</a>(<span class="stringliteral">&quot;error when receiving first part of message from server&quot;</span>);
<a name="l00592"></a>00592 
<a name="l00593"></a>00593       <span class="comment">// if timeout and not one byte has arrived then don&#39;t close connection</span>
<a name="l00594"></a>00594       <span class="keywordflow">if</span> (<a class="code" href="classClient.html#ae6e3c294a22e2bdcc8a4893e193ce7d3" title="Tells id there has been a timeout after a receive operations ends in error.">timeoutOccurred</a> &amp;&amp; (<a class="code" href="classClient.html#ab8d2b8c93dc01b7a6ff54c8a06198302" title="Contains the type of the error that occurred immediately after a socket operation...">lastErrorType</a> != <a class="code" href="Client_8c.html#a06fc87d81c62e9abb8790b6e5713c55bac3981c1a31844f03343a22bc511e4f4b">ERRTYPE_FORMAT</a>))
<a name="l00595"></a>00595          <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00596"></a>00596       <span class="keywordflow">goto</span> ERROR_WITH_CLOSE;
<a name="l00597"></a>00597    }
<a name="l00598"></a>00598 
<a name="l00599"></a>00599    <span class="comment">// consistency check</span>
<a name="l00600"></a>00600    <span class="keywordflow">if</span> (!<a class="code" href="Message_8h.html#a3e36335cd07843fe87db161b6b5ef9a3" title="see Message::message_isValidPrefix">message_isValidPrefix</a>(msg))
<a name="l00601"></a>00601    {
<a name="l00602"></a>00602       <a class="code" href="Log_8h.html#aa62b9042f25fb0b8205e108ed438a1a6" title="log error record with function identification (see Log::log_fheader)">log_ferror</a>(<span class="stringliteral">&quot;invalid message prefix [%c] received from server&quot;</span>,
<a name="l00603"></a>00603          <a class="code" href="Message_8h.html#aee7425cb32cff0e3aa1703ea591373af" title="see Message::message_prefix">message_prefix</a>(msg));
<a name="l00604"></a>00604       <span class="keywordflow">goto</span> FORMAT_ERROR_WITH_CLOSE;
<a name="l00605"></a>00605    }
<a name="l00606"></a>00606 
<a name="l00607"></a>00607    <span class="comment">// consistency check</span>
<a name="l00608"></a>00608    <span class="keywordflow">if</span> (<a class="code" href="Message_8h.html#a52415b8242eb5a34b6249d8f9b0cb0f3" title="see Message::message_size">message_size</a>(msg) &gt; <a class="code" href="Message_8h.html#ad79085024874f86561123dba96ae34ae" title="see Message::message_maxBodySize">message_maxBodySize</a>())
<a name="l00609"></a>00609    {
<a name="l00610"></a>00610       <a class="code" href="Log_8h.html#aa62b9042f25fb0b8205e108ed438a1a6" title="log error record with function identification (see Log::log_fheader)">log_ferror</a>(<span class="stringliteral">&quot;invalid message size [%d] received from server&quot;</span>,
<a name="l00611"></a>00611           <a class="code" href="Message_8h.html#a52415b8242eb5a34b6249d8f9b0cb0f3" title="see Message::message_size">message_size</a>(msg));
<a name="l00612"></a>00612       <span class="keywordflow">goto</span> FORMAT_ERROR_WITH_CLOSE;
<a name="l00613"></a>00613    }
<a name="l00614"></a>00614 
<a name="l00615"></a>00615    <span class="comment">// tries to receive the message&#39;s second part</span>
<a name="l00616"></a>00616    <a class="code" href="Log_8h.html#ab4478c2e145cf2707099a4676a81a2d6" title="log debug record with function identification (see Log::log_fheader)">log_fdebug</a>(<span class="stringliteral">&quot;trying to receive %d bytes (second part of message)&quot;</span>,
<a name="l00617"></a>00617       <a class="code" href="Message_8h.html#a2ce7590ea639b229357b29c187c2a2f4" title="see Message::message_size2">message_size2</a>(msg));
<a name="l00618"></a>00618 
<a name="l00619"></a>00619    ret = <a class="code" href="classClient.html#ac1a0ff1d1c2453cc22c028da29fcb115" title="Receives a specific-length buffer from peer application, and checks for error.">recvBuffer</a>(<a class="code" href="classClient.html#adc5475d507e3d713ad405bbeb6eb41e7" title="The client socket.">clientSocket</a>, <a class="code" href="Message_8h.html#abd75d5c27798093d703c092bbaf40ef2" title="see Message::message_start">message_start</a>(msg)+<a class="code" href="Message_8h.html#ab2c30f86b55850b3e0859fc37b9e6aa1" title="see Message::message_size1">message_size1</a>(),
<a name="l00620"></a>00620       <a class="code" href="Message_8h.html#a2ce7590ea639b229357b29c187c2a2f4" title="see Message::message_size2">message_size2</a>(msg), REM_TIME, <span class="keyword">false</span> <span class="comment">/*not first part of message*/</span>);
<a name="l00621"></a>00621 
<a name="l00622"></a>00622    <span class="keywordflow">if</span> (ret != (<span class="keywordtype">int</span>)<a class="code" href="Message_8h.html#a2ce7590ea639b229357b29c187c2a2f4" title="see Message::message_size2">message_size2</a>(msg))
<a name="l00623"></a>00623    {
<a name="l00624"></a>00624       <a class="code" href="Log_8h.html#aa62b9042f25fb0b8205e108ed438a1a6" title="log error record with function identification (see Log::log_fheader)">log_ferror</a>(<span class="stringliteral">&quot;error when receiving seconf part of message from server&quot;</span>);
<a name="l00625"></a>00625       <span class="keywordflow">goto</span> ERROR_WITH_CLOSE;
<a name="l00626"></a>00626    }
<a name="l00627"></a>00627 
<a name="l00628"></a>00628    <span class="comment">// consistency check</span>
<a name="l00629"></a>00629    <span class="keywordflow">if</span> (!<a class="code" href="Message_8h.html#a5532aa785069586eb5cb0950bc89e630" title="see Message::message_isValidSuffix">message_isValidSuffix</a>(msg))
<a name="l00630"></a>00630    {
<a name="l00631"></a>00631       <a class="code" href="Log_8h.html#aa62b9042f25fb0b8205e108ed438a1a6" title="log error record with function identification (see Log::log_fheader)">log_ferror</a>(<span class="stringliteral">&quot;invalid message suffix [%c] received from server&quot;</span>,
<a name="l00632"></a>00632          <a class="code" href="Message_8h.html#a4bda33d4f9469e060c37f2986dd286f3" title="see Message::message_suffix">message_suffix</a>(msg));
<a name="l00633"></a>00633       <span class="keywordflow">goto</span> FORMAT_ERROR_WITH_CLOSE;
<a name="l00634"></a>00634    }
<a name="l00635"></a>00635 
<a name="l00636"></a>00636    <a class="code" href="Log_8h.html#ab4478c2e145cf2707099a4676a81a2d6" title="log debug record with function identification (see Log::log_fheader)">log_fdebug</a>(<span class="stringliteral">&quot;received %d bytes from server, body:%d orgId:%d orgSeq:%d&quot;</span>,
<a name="l00637"></a>00637       <a class="code" href="Message_8h.html#ab2c30f86b55850b3e0859fc37b9e6aa1" title="see Message::message_size1">message_size1</a>()+<a class="code" href="Message_8h.html#a2ce7590ea639b229357b29c187c2a2f4" title="see Message::message_size2">message_size2</a>(msg), <a class="code" href="Message_8h.html#a52415b8242eb5a34b6249d8f9b0cb0f3" title="see Message::message_size">message_size</a>(msg),
<a name="l00638"></a>00638       <a class="code" href="Message_8h.html#ad8b7b738ecb16a51de905ff169b3ee30" title="see Message::message_orgId">message_orgId</a>(msg), <a class="code" href="Message_8h.html#a2d444165c65e9e524e8e6a10eb008359" title="see Message::message_orgSeqNo">message_orgSeqNo</a>(msg));
<a name="l00639"></a>00639 
<a name="l00640"></a>00640    <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00641"></a>00641 
<a name="l00642"></a>00642 FORMAT_ERROR_WITH_CLOSE:
<a name="l00643"></a>00643    <a class="code" href="classClient.html#ada0babaa8c1187b1c28fac649bb6ecef" title="Tells if there has been a format error on the wire right after a receive operation...">formatError</a> = <span class="keyword">true</span>;
<a name="l00644"></a>00644    <a class="code" href="classClient.html#ab8d2b8c93dc01b7a6ff54c8a06198302" title="Contains the type of the error that occurred immediately after a socket operation...">lastErrorType</a> = <a class="code" href="Client_8c.html#a06fc87d81c62e9abb8790b6e5713c55bac3981c1a31844f03343a22bc511e4f4b">ERRTYPE_FORMAT</a>;
<a name="l00645"></a>00645 ERROR_WITH_CLOSE:
<a name="l00646"></a>00646    <a class="code" href="Log_8h.html#a58100c42301c30599a1d148e9771646d" title="log warning record with function identification (see Log::log_fheader)">log_fwarn</a>(msgclose);
<a name="l00647"></a>00647    <a class="code" href="classClient.html#ac1b8a1bcc592b90be708f53c6f3379c8" title="Closes the connection.">client_closeConnection</a>();
<a name="l00648"></a>00648    <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00649"></a>00649 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad12e0cdab8fa5ba7aa64865ec0b23b38"></a><!-- doxytag: member="Client::client_sendMessage" ref="ad12e0cdab8fa5ba7aa64865ec0b23b38" args="(Message *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TC2API <a class="el" href="config_8h.html#a6e2560c92901098cb3cd008a79dcdeba">bool</a> client_sendMessage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMessage.html">Message</a> *&nbsp;</td>
          <td class="paramname"> <em>msg</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Tries to send a message to the server. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>msg</em>&nbsp;</td><td>: address of a <a class="el" href="structMessage.html" title="Message data structure.">Message</a> structure with the data that will be sent to the server</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>true (operation successful) / false (operation failed) </dd></dl>

<p>Definition at line <a class="el" href="Client_8c_source.html#l00667">667</a> of file <a class="el" href="Client_8c_source.html">Client.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00668"></a>00668 {
<a name="l00669"></a>00669    <span class="keywordtype">int</span> ret, size;
<a name="l00670"></a>00670    <a class="code" href="Log_8h.html#aba64819ead3a2defc230ec7ccf655c4e" title="standard source file name for inclusion in log">log_func</a>(<a class="code" href="classClient.html#ad12e0cdab8fa5ba7aa64865ec0b23b38" title="Tries to send a message to the server.">client_sendMessage</a>);
<a name="l00671"></a>00671 
<a name="l00672"></a>00672    assert(msg);
<a name="l00673"></a>00673 
<a name="l00674"></a>00674    <span class="comment">// to make it easier to find this message in the server&#39;s log</span>
<a name="l00675"></a>00675    <a class="code" href="Message_8h.html#a1d5961c1e7523eacb415b37ac0202a43" title="see Message::message_setOrgId">message_setOrgId</a>(msg, <a class="code" href="Thread_8h.html#af3c1431be1989bc994d540a5dbb584c8" title="The current process id provided by the operating system.">thread_pid</a>());
<a name="l00676"></a>00676    <a class="code" href="Message_8h.html#a7898cab691c81314107190749f4bbd1a" title="see Message::message_setOrgSeqNo">message_setOrgSeqNo</a>(msg, <a class="code" href="classClient.html#a258ded446f21a1edd363ab196974c202" title="Global counter used when sending messages.">orgSeqNo</a>++);
<a name="l00677"></a>00677 
<a name="l00678"></a>00678    size = <a class="code" href="Message_8h.html#ab2c30f86b55850b3e0859fc37b9e6aa1" title="see Message::message_size1">message_size1</a>() + <a class="code" href="Message_8h.html#a2ce7590ea639b229357b29c187c2a2f4" title="see Message::message_size2">message_size2</a>(msg);
<a name="l00679"></a>00679 
<a name="l00680"></a>00680    <span class="comment">// clears indicators</span>
<a name="l00681"></a>00681    <a class="code" href="classClient.html#ab825728c14e12d04922f751c3f67cb0a" title="Contains the number of the error that occurred immediately after a socket operation...">lastSocketError</a> = 0;
<a name="l00682"></a>00682    <a class="code" href="classClient.html#ab8d2b8c93dc01b7a6ff54c8a06198302" title="Contains the type of the error that occurred immediately after a socket operation...">lastErrorType</a> = 0;
<a name="l00683"></a>00683    <a class="code" href="classClient.html#ae6e3c294a22e2bdcc8a4893e193ce7d3" title="Tells id there has been a timeout after a receive operations ends in error.">timeoutOccurred</a> = <span class="keyword">false</span>;
<a name="l00684"></a>00684 
<a name="l00685"></a>00685    <span class="comment">// tries to send the message</span>
<a name="l00686"></a>00686    <a class="code" href="Log_8h.html#ab4478c2e145cf2707099a4676a81a2d6" title="log debug record with function identification (see Log::log_fheader)">log_fdebug</a>(<span class="stringliteral">&quot;sending %d bytes to server, body:%d orgId:%d orgSeq:%d&quot;</span>,
<a name="l00687"></a>00687       size, <a class="code" href="Message_8h.html#a52415b8242eb5a34b6249d8f9b0cb0f3" title="see Message::message_size">message_size</a>(msg), <a class="code" href="Message_8h.html#ad8b7b738ecb16a51de905ff169b3ee30" title="see Message::message_orgId">message_orgId</a>(msg), <a class="code" href="Message_8h.html#a2d444165c65e9e524e8e6a10eb008359" title="see Message::message_orgSeqNo">message_orgSeqNo</a>(msg));
<a name="l00688"></a>00688 
<a name="l00689"></a>00689    ret = <a class="code" href="Socket_8h.html#a19d87a8122611d7dcb0516012259eeb3" title="see Socket::socket_sendBuffer">socket_sendBuffer</a>(<a class="code" href="classClient.html#adc5475d507e3d713ad405bbeb6eb41e7" title="The client socket.">clientSocket</a>, <a class="code" href="Message_8h.html#abd75d5c27798093d703c092bbaf40ef2" title="see Message::message_start">message_start</a>(msg), size, <a class="code" href="classClient.html#ac6ebab6dbd29d69c58e999ec0273f074" title="Default timeout in seconds when sending a message to the server.">sendTimeout</a>,
<a name="l00690"></a>00690       <a class="code" href="classClient.html#aede8ee1d904b3abd665f17607902ed4a" title="Tells if tracing is enabled.">isTracing</a>);
<a name="l00691"></a>00691 
<a name="l00692"></a>00692    <span class="keywordflow">if</span> (ret == size)
<a name="l00693"></a>00693    {
<a name="l00694"></a>00694       <a class="code" href="Log_8h.html#ab4478c2e145cf2707099a4676a81a2d6" title="log debug record with function identification (see Log::log_fheader)">log_fdebug</a>(<span class="stringliteral">&quot;ok, message sent successfully&quot;</span>);
<a name="l00695"></a>00695       <span class="keywordflow">return</span> <span class="keyword">true</span>; <span class="comment">// ok</span>
<a name="l00696"></a>00696    }
<a name="l00697"></a>00697 
<a name="l00698"></a>00698    <span class="keywordflow">if</span> (ret == <a class="code" href="Socket_8h.html#ad38171878628c67def4c5bca6a6caf76" title="Generic timeout Socket error.">E_SOCKET_TIMEOUT</a>)
<a name="l00699"></a>00699    {
<a name="l00700"></a>00700       <a class="code" href="Log_8h.html#a58100c42301c30599a1d148e9771646d" title="log warning record with function identification (see Log::log_fheader)">log_fwarn</a>(<span class="stringliteral">&quot;timeout occurred when writing socket&quot;</span>);
<a name="l00701"></a>00701       <a class="code" href="classClient.html#ae6e3c294a22e2bdcc8a4893e193ce7d3" title="Tells id there has been a timeout after a receive operations ends in error.">timeoutOccurred</a> = <span class="keyword">true</span>;
<a name="l00702"></a>00702       <a class="code" href="classClient.html#ab8d2b8c93dc01b7a6ff54c8a06198302" title="Contains the type of the error that occurred immediately after a socket operation...">lastErrorType</a> = <a class="code" href="Client_8c.html#a06fc87d81c62e9abb8790b6e5713c55babd24a4212144b1a877f17b8631302e1a">ERRTYPE_SENDTIMEOUT</a>;
<a name="l00703"></a>00703    }
<a name="l00704"></a>00704 
<a name="l00705"></a>00705    <span class="keywordflow">else</span> <span class="comment">// if (ret == SOCKET_ERROR)</span>
<a name="l00706"></a>00706    {
<a name="l00707"></a>00707       <a class="code" href="classClient.html#ab825728c14e12d04922f751c3f67cb0a" title="Contains the number of the error that occurred immediately after a socket operation...">lastSocketError</a> = socket_error();
<a name="l00708"></a>00708       <a class="code" href="Log_8h.html#aa62b9042f25fb0b8205e108ed438a1a6" title="log error record with function identification (see Log::log_fheader)">log_ferror</a>(<span class="stringliteral">&quot;error %d when writing socket&quot;</span>, <a class="code" href="classClient.html#ab825728c14e12d04922f751c3f67cb0a" title="Contains the number of the error that occurred immediately after a socket operation...">lastSocketError</a>);
<a name="l00709"></a>00709       <a class="code" href="classClient.html#ab8d2b8c93dc01b7a6ff54c8a06198302" title="Contains the type of the error that occurred immediately after a socket operation...">lastErrorType</a> = <a class="code" href="Client_8c.html#a06fc87d81c62e9abb8790b6e5713c55ba4617be5fd3ac8450ebbb6e5bfc4e17e7">ERRTYPE_SOCKET</a>;
<a name="l00710"></a>00710    }
<a name="l00711"></a>00711 
<a name="l00712"></a>00712    <a class="code" href="Log_8h.html#a58100c42301c30599a1d148e9771646d" title="log warning record with function identification (see Log::log_fheader)">log_fwarn</a>(<span class="stringliteral">&quot;now closing connection&quot;</span>);
<a name="l00713"></a>00713    <a class="code" href="classClient.html#ac1b8a1bcc592b90be708f53c6f3379c8" title="Closes the connection.">client_closeConnection</a>();
<a name="l00714"></a>00714 
<a name="l00715"></a>00715    <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00716"></a>00716 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aff7978dd9e2e6d96ac19e377a18616e5"></a><!-- doxytag: member="Client::client_setReplyTimeout" ref="aff7978dd9e2e6d96ac19e377a18616e5" args="(ushort seconds)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TC2API void client_setReplyTimeout </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="config_8h.html#ab95f123a6c9bcfee6a343170ef8c5f69">ushort</a>&nbsp;</td>
          <td class="paramname"> <em>seconds</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Configures how many seconds to wait for a reply from the server. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>seconds</em>&nbsp;</td><td>: how many seconds to wait for a reply from the server. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="Client_8c_source.html#l00730">730</a> of file <a class="el" href="Client_8c_source.html">Client.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00731"></a>00731 {
<a name="l00732"></a>00732    <a class="code" href="Log_8h.html#aba64819ead3a2defc230ec7ccf655c4e" title="standard source file name for inclusion in log">log_func</a>(<a class="code" href="classClient.html#aff7978dd9e2e6d96ac19e377a18616e5" title="Configures how many seconds to wait for a reply from the server.">client_setReplyTimeout</a>);
<a name="l00733"></a>00733    <a class="code" href="Log_8h.html#a619ac1ab71ab5d1c7e94e03ddbf16d3b" title="log informational record with function identification (see Log::log_fheader)">log_finfo</a>(<span class="stringliteral">&quot;reply timeout: %d seconds&quot;</span>, seconds);
<a name="l00734"></a>00734 
<a name="l00735"></a>00735    <a class="code" href="classClient.html#a337c42b5e32a1f92420bd21afa6c1f85" title="Default server reply timeout in seconds.">replyTimeout</a> = seconds;
<a name="l00736"></a>00736 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af468f4e75580ec6ab7a8abd967183032"></a><!-- doxytag: member="Client::client_setServerAddress" ref="af468f4e75580ec6ab7a8abd967183032" args="(cchar *ipAddress)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TC2API void client_setServerAddress </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="config_8h.html#a0f128c3e0c83721af0220c00554e9c4e">cchar</a> *&nbsp;</td>
          <td class="paramname"> <em>ipAddress</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Configures the server IP address. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ipAddress</em>&nbsp;</td><td>: IP address of the server </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="Client_8c_source.html#l00750">750</a> of file <a class="el" href="Client_8c_source.html">Client.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00751"></a>00751 {
<a name="l00752"></a>00752    <a class="code" href="Log_8h.html#aba64819ead3a2defc230ec7ccf655c4e" title="standard source file name for inclusion in log">log_func</a>(<a class="code" href="classClient.html#af468f4e75580ec6ab7a8abd967183032" title="Configures the server IP address.">client_setServerAddress</a>);
<a name="l00753"></a>00753    <a class="code" href="Log_8h.html#a619ac1ab71ab5d1c7e94e03ddbf16d3b" title="log informational record with function identification (see Log::log_fheader)">log_finfo</a>(<span class="stringliteral">&quot;using server address: %s&quot;</span>, ipAddress);
<a name="l00754"></a>00754 
<a name="l00755"></a>00755    strncpy(<a class="code" href="classClient.html#ab60a34da8654480c6bba7ac1df2da8c3" title="Default server IP address as string.">serverAddressStr</a>, ipAddress, <span class="keyword">sizeof</span>(<a class="code" href="classClient.html#ab60a34da8654480c6bba7ac1df2da8c3" title="Default server IP address as string.">serverAddressStr</a>)-1);
<a name="l00756"></a>00756    <a class="code" href="classClient.html#a6dee50ddcd3fa9bd16c33ea160d15ae6" title="Default server IP address in binary (127.1).">serverAddress</a> = inet_addr(<a class="code" href="classClient.html#ab60a34da8654480c6bba7ac1df2da8c3" title="Default server IP address as string.">serverAddressStr</a>);
<a name="l00757"></a>00757 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3358a12decc93d997ef2a27110173a01"></a><!-- doxytag: member="Client::client_setServicePort" ref="a3358a12decc93d997ef2a27110173a01" args="(ushort port)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TC2API void client_setServicePort </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="config_8h.html#ab95f123a6c9bcfee6a343170ef8c5f69">ushort</a>&nbsp;</td>
          <td class="paramname"> <em>port</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Configures the server TCP port. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>: service port on which the server is waiting. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="Client_8c_source.html#l00771">771</a> of file <a class="el" href="Client_8c_source.html">Client.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00772"></a>00772 {
<a name="l00773"></a>00773    <a class="code" href="Log_8h.html#aba64819ead3a2defc230ec7ccf655c4e" title="standard source file name for inclusion in log">log_func</a>(<a class="code" href="classClient.html#a3358a12decc93d997ef2a27110173a01" title="Configures the server TCP port.">client_setServicePort</a>);
<a name="l00774"></a>00774    <a class="code" href="Log_8h.html#a619ac1ab71ab5d1c7e94e03ddbf16d3b" title="log informational record with function identification (see Log::log_fheader)">log_finfo</a>(<span class="stringliteral">&quot;using port: %d&quot;</span>, port);
<a name="l00775"></a>00775 
<a name="l00776"></a>00776    <a class="code" href="classClient.html#ac289967d57409c9bfe8d380f777bca9e" title="Default server TCP port.">servicePort</a> = port;
<a name="l00777"></a>00777 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a46c987e1550f39b919ea87969ac08f9e"></a><!-- doxytag: member="Client::client_setTrace" ref="a46c987e1550f39b919ea87969ac08f9e" args="(bool flag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TC2API void client_setTrace </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="config_8h.html#a6e2560c92901098cb3cd008a79dcdeba">bool</a>&nbsp;</td>
          <td class="paramname"> <em>flag</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Enables or disables tracing. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>flag</em>&nbsp;</td><td>: true/false </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="Client_8c_source.html#l00791">791</a> of file <a class="el" href="Client_8c_source.html">Client.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00792"></a>00792 {
<a name="l00793"></a>00793    <a class="code" href="classClient.html#aede8ee1d904b3abd665f17607902ed4a" title="Tells if tracing is enabled.">isTracing</a> = flag;
<a name="l00794"></a>00794 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="abd9d963db56bc1578cb78c5db866c786"></a><!-- doxytag: member="Client::client_timeout" ref="abd9d963db56bc1578cb78c5db866c786" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TC2API <a class="el" href="config_8h.html#a6e2560c92901098cb3cd008a79dcdeba">bool</a> client_timeout </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reports if there has been a timeout after a receive operations ends in error. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>true (timeout occurred) / false (timeout not occurred) </dd></dl>

<p>Definition at line <a class="el" href="Client_8c_source.html#l00809">809</a> of file <a class="el" href="Client_8c_source.html">Client.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00810"></a>00810 {
<a name="l00811"></a>00811    <span class="keywordflow">return</span> (<a class="code" href="classClient.html#ae6e3c294a22e2bdcc8a4893e193ce7d3" title="Tells id there has been a timeout after a receive operations ends in error.">timeoutOccurred</a> &amp;&amp; (<a class="code" href="classClient.html#ab8d2b8c93dc01b7a6ff54c8a06198302" title="Contains the type of the error that occurred immediately after a socket operation...">lastErrorType</a> == <a class="code" href="Client_8c.html#a06fc87d81c62e9abb8790b6e5713c55bac3981c1a31844f03343a22bc511e4f4b">ERRTYPE_FORMAT</a>));
<a name="l00812"></a>00812 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac1a0ff1d1c2453cc22c028da29fcb115"></a><!-- doxytag: member="Client::recvBuffer" ref="ac1a0ff1d1c2453cc22c028da29fcb115" args="(int socket, char *buf, int len, unsigned nSeconds, bool firstPart)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int recvBuffer </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>socket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&nbsp;</td>
          <td class="paramname"> <em>nSeconds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="config_8h.html#a6e2560c92901098cb3cd008a79dcdeba">bool</a>&nbsp;</td>
          <td class="paramname"> <em>firstPart</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Receives a specific-length buffer from peer application, and checks for error. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>number of bytes received, or error</dd></dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>the</em>&nbsp;</td><td>number of bytes received, or error</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>: (SOCKET_CLOSED) connection was closed by the server.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>: (SOCKET_ERROR) an error occurred.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-2</em>&nbsp;</td><td>: (SOCKET_TIMEOUT) not all bytes arrived within the specified time interval. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="Client_8c_source.html#l00840">840</a> of file <a class="el" href="Client_8c_source.html">Client.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00842"></a>00842 {
<a name="l00843"></a>00843    <span class="keywordtype">int</span> ret;
<a name="l00844"></a>00844    <a class="code" href="Log_8h.html#aba64819ead3a2defc230ec7ccf655c4e" title="standard source file name for inclusion in log">log_func</a>(<a class="code" href="classClient.html#ac1a0ff1d1c2453cc22c028da29fcb115" title="Receives a specific-length buffer from peer application, and checks for error.">recvBuffer</a>);
<a name="l00845"></a>00845 
<a name="l00846"></a>00846    <span class="comment">// clears indicators</span>
<a name="l00847"></a>00847    <a class="code" href="classClient.html#ad3973a11a1a20211111f43cb17b5ee31" title="Tells if the connection has been closed after an operation end in error.">connectionClosed</a> = <span class="keyword">false</span>;
<a name="l00848"></a>00848    <a class="code" href="classClient.html#ada0babaa8c1187b1c28fac649bb6ecef" title="Tells if there has been a format error on the wire right after a receive operation...">formatError</a> = <span class="keyword">false</span>;
<a name="l00849"></a>00849    <a class="code" href="classClient.html#ab825728c14e12d04922f751c3f67cb0a" title="Contains the number of the error that occurred immediately after a socket operation...">lastSocketError</a> = 0;
<a name="l00850"></a>00850    <a class="code" href="classClient.html#ab8d2b8c93dc01b7a6ff54c8a06198302" title="Contains the type of the error that occurred immediately after a socket operation...">lastErrorType</a> = 0;
<a name="l00851"></a>00851    <a class="code" href="classClient.html#ae6e3c294a22e2bdcc8a4893e193ce7d3" title="Tells id there has been a timeout after a receive operations ends in error.">timeoutOccurred</a> = <span class="keyword">false</span>;
<a name="l00852"></a>00852 
<a name="l00853"></a>00853    ret = <a class="code" href="Socket_8h.html#a2cb9c6f36745fa48604e187edc8595ca" title="see Socket::socket_recvBuffer">socket_recvBuffer</a>(socket, buf, len, nSeconds, <a class="code" href="classClient.html#aede8ee1d904b3abd665f17607902ed4a" title="Tells if tracing is enabled.">isTracing</a>);
<a name="l00854"></a>00854 
<a name="l00855"></a>00855    <span class="keywordflow">if</span> (ret == len) <span class="comment">// most likely result</span>
<a name="l00856"></a>00856       <span class="keywordflow">goto</span> END;
<a name="l00857"></a>00857 
<a name="l00858"></a>00858    <span class="keywordflow">if</span> (ret == <a class="code" href="Socket_8h.html#a72e38dd6cde0964f3a83c1c19d284bd9" title="Socket closed on reception.">E_SOCKET_CLOSED</a>) <span class="comment">// second most likely result</span>
<a name="l00859"></a>00859    {
<a name="l00860"></a>00860       <a class="code" href="Log_8h.html#a58100c42301c30599a1d148e9771646d" title="log warning record with function identification (see Log::log_fheader)">log_fwarn</a>(<span class="stringliteral">&quot;connection closed when reading socket&quot;</span>);
<a name="l00861"></a>00861       <a class="code" href="classClient.html#ad3973a11a1a20211111f43cb17b5ee31" title="Tells if the connection has been closed after an operation end in error.">connectionClosed</a> = <span class="keyword">true</span>;
<a name="l00862"></a>00862       <a class="code" href="classClient.html#ab8d2b8c93dc01b7a6ff54c8a06198302" title="Contains the type of the error that occurred immediately after a socket operation...">lastErrorType</a> = <a class="code" href="Client_8c.html#a06fc87d81c62e9abb8790b6e5713c55ba52dc8b1c53f593e8e1ed2da20b996a92">ERRTYPE_CLOSED</a>;
<a name="l00863"></a>00863       <span class="keywordflow">goto</span> END;
<a name="l00864"></a>00864    }
<a name="l00865"></a>00865 
<a name="l00866"></a>00866    <span class="keywordflow">if</span> (ret == <a class="code" href="Socket_8h.html#ad38171878628c67def4c5bca6a6caf76" title="Generic timeout Socket error.">E_SOCKET_TIMEOUT</a>) <span class="comment">// third most likely result</span>
<a name="l00867"></a>00867    {
<a name="l00868"></a>00868       <a class="code" href="Log_8h.html#a58100c42301c30599a1d148e9771646d" title="log warning record with function identification (see Log::log_fheader)">log_fwarn</a>(<span class="stringliteral">&quot;timeout occurred when reading socket&quot;</span>);
<a name="l00869"></a>00869       <span class="comment">// timeout not considered error if not one byte received,</span>
<a name="l00870"></a>00870       <span class="comment">// only considered error if occurs int the middle of a message</span>
<a name="l00871"></a>00871       <span class="keywordflow">if</span> (!firstPart || <a class="code" href="Socket_8h.html#aa52c2cece2efbec8249847514a5c65fb" title="see Socket::socket_partialLenReceived">socket_partialLenReceived</a>())
<a name="l00872"></a>00872          <a class="code" href="classClient.html#ab8d2b8c93dc01b7a6ff54c8a06198302" title="Contains the type of the error that occurred immediately after a socket operation...">lastErrorType</a> = <a class="code" href="Client_8c.html#a06fc87d81c62e9abb8790b6e5713c55bac3981c1a31844f03343a22bc511e4f4b">ERRTYPE_FORMAT</a>;
<a name="l00873"></a>00873       <a class="code" href="classClient.html#ae6e3c294a22e2bdcc8a4893e193ce7d3" title="Tells id there has been a timeout after a receive operations ends in error.">timeoutOccurred</a> = <span class="keyword">true</span>;
<a name="l00874"></a>00874       <span class="keywordflow">goto</span> END;
<a name="l00875"></a>00875    }
<a name="l00876"></a>00876 
<a name="l00877"></a>00877    <span class="keywordflow">if</span> (ret == <a class="code" href="Socket_8h.html#a114f76181c8d260f8c67f73736a6f232" title="Generic Socket error definition.">E_SOCKET_ERROR</a>) <span class="comment">// fourth most likely result</span>
<a name="l00878"></a>00878    {
<a name="l00879"></a>00879       <a class="code" href="classClient.html#ab825728c14e12d04922f751c3f67cb0a" title="Contains the number of the error that occurred immediately after a socket operation...">lastSocketError</a> = socket_error();
<a name="l00880"></a>00880       <a class="code" href="Log_8h.html#aa62b9042f25fb0b8205e108ed438a1a6" title="log error record with function identification (see Log::log_fheader)">log_ferror</a>(<span class="stringliteral">&quot;error %d when reading socket&quot;</span>, <a class="code" href="classClient.html#ab825728c14e12d04922f751c3f67cb0a" title="Contains the number of the error that occurred immediately after a socket operation...">lastSocketError</a>);
<a name="l00881"></a>00881       <a class="code" href="classClient.html#ab8d2b8c93dc01b7a6ff54c8a06198302" title="Contains the type of the error that occurred immediately after a socket operation...">lastErrorType</a> = <a class="code" href="Client_8c.html#a06fc87d81c62e9abb8790b6e5713c55ba4617be5fd3ac8450ebbb6e5bfc4e17e7">ERRTYPE_SOCKET</a>;
<a name="l00882"></a>00882       <span class="keywordflow">goto</span> END;
<a name="l00883"></a>00883    }
<a name="l00884"></a>00884 
<a name="l00885"></a>00885    <span class="comment">// should not happen (!)</span>
<a name="l00886"></a>00886    abort();
<a name="l00887"></a>00887 
<a name="l00888"></a>00888 END:
<a name="l00889"></a>00889    <span class="keywordflow">return</span> ret;
<a name="l00890"></a>00890 }
</pre></div></p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="adc5475d507e3d713ad405bbeb6eb41e7"></a><!-- doxytag: member="Client::clientSocket" ref="adc5475d507e3d713ad405bbeb6eb41e7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classClient.html#adc5475d507e3d713ad405bbeb6eb41e7">clientSocket</a><code> [static, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The client socket. </p>

<p>Definition at line <a class="el" href="Client_8c_source.html#l00308">308</a> of file <a class="el" href="Client_8c_source.html">Client.c</a>.</p>

</div>
</div>
<a class="anchor" id="ad3973a11a1a20211111f43cb17b5ee31"></a><!-- doxytag: member="Client::connectionClosed" ref="ad3973a11a1a20211111f43cb17b5ee31" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="config_8h.html#a6e2560c92901098cb3cd008a79dcdeba">bool</a> <a class="el" href="classClient.html#ad3973a11a1a20211111f43cb17b5ee31">connectionClosed</a><code> [static, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Tells if the connection has been closed after an operation end in error. </p>

<p>Definition at line <a class="el" href="Client_8c_source.html#l00330">330</a> of file <a class="el" href="Client_8c_source.html">Client.c</a>.</p>

</div>
</div>
<a class="anchor" id="ada0babaa8c1187b1c28fac649bb6ecef"></a><!-- doxytag: member="Client::formatError" ref="ada0babaa8c1187b1c28fac649bb6ecef" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="config_8h.html#a6e2560c92901098cb3cd008a79dcdeba">bool</a> <a class="el" href="classClient.html#ada0babaa8c1187b1c28fac649bb6ecef">formatError</a><code> [static, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Tells if there has been a format error on the wire right after a receive operation. </p>

<p>Definition at line <a class="el" href="Client_8c_source.html#l00335">335</a> of file <a class="el" href="Client_8c_source.html">Client.c</a>.</p>

</div>
</div>
<a class="anchor" id="ada1a895a5ff67fb36ed9a4765f2274d2"></a><!-- doxytag: member="Client::isConnected" ref="ada1a895a5ff67fb36ed9a4765f2274d2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="config_8h.html#a6e2560c92901098cb3cd008a79dcdeba">bool</a> <a class="el" href="classClient.html#ada1a895a5ff67fb36ed9a4765f2274d2">isConnected</a><code> [static, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>State of the connection. </p>

<p>Definition at line <a class="el" href="Client_8c_source.html#l00322">322</a> of file <a class="el" href="Client_8c_source.html">Client.c</a>.</p>

</div>
</div>
<a class="anchor" id="aede8ee1d904b3abd665f17607902ed4a"></a><!-- doxytag: member="Client::isTracing" ref="aede8ee1d904b3abd665f17607902ed4a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="config_8h.html#a6e2560c92901098cb3cd008a79dcdeba">bool</a> <a class="el" href="classClient.html#aede8ee1d904b3abd665f17607902ed4a">isTracing</a><code> [static, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Tells if tracing is enabled. </p>

<p>Definition at line <a class="el" href="Client_8c_source.html#l00366">366</a> of file <a class="el" href="Client_8c_source.html">Client.c</a>.</p>

</div>
</div>
<a class="anchor" id="ab8d2b8c93dc01b7a6ff54c8a06198302"></a><!-- doxytag: member="Client::lastErrorType" ref="ab8d2b8c93dc01b7a6ff54c8a06198302" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classClient.html#ab8d2b8c93dc01b7a6ff54c8a06198302">lastErrorType</a><code> [static, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Contains the type of the error that occurred immediately after a socket operation. </p>

<p>Definition at line <a class="el" href="Client_8c_source.html#l00345">345</a> of file <a class="el" href="Client_8c_source.html">Client.c</a>.</p>

</div>
</div>
<a class="anchor" id="ab825728c14e12d04922f751c3f67cb0a"></a><!-- doxytag: member="Client::lastSocketError" ref="ab825728c14e12d04922f751c3f67cb0a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classClient.html#ab825728c14e12d04922f751c3f67cb0a">lastSocketError</a><code> [static, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Contains the number of the error that occurred immediately after a socket operation. </p>

<p>Definition at line <a class="el" href="Client_8c_source.html#l00340">340</a> of file <a class="el" href="Client_8c_source.html">Client.c</a>.</p>

</div>
</div>
<a class="anchor" id="a258ded446f21a1edd363ab196974c202"></a><!-- doxytag: member="Client::orgSeqNo" ref="a258ded446f21a1edd363ab196974c202" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="config_8h.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="el" href="classClient.html#a258ded446f21a1edd363ab196974c202">orgSeqNo</a><code> [static, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Global counter used when sending messages. </p>

<p>Definition at line <a class="el" href="Client_8c_source.html#l00292">292</a> of file <a class="el" href="Client_8c_source.html">Client.c</a>.</p>

</div>
</div>
<a class="anchor" id="a337c42b5e32a1f92420bd21afa6c1f85"></a><!-- doxytag: member="Client::replyTimeout" ref="a337c42b5e32a1f92420bd21afa6c1f85" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="config_8h.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="el" href="classClient.html#a337c42b5e32a1f92420bd21afa6c1f85">replyTimeout</a> = ((<a class="el" href="config_8h.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>)-1)<code> [static, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Default server reply timeout in seconds. </p>
<p>(0 means immediate, -1 means infinite). </p>

<p>Definition at line <a class="el" href="Client_8c_source.html#l00313">313</a> of file <a class="el" href="Client_8c_source.html">Client.c</a>.</p>

</div>
</div>
<a class="anchor" id="ac6ebab6dbd29d69c58e999ec0273f074"></a><!-- doxytag: member="Client::sendTimeout" ref="ac6ebab6dbd29d69c58e999ec0273f074" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="config_8h.html#ab95f123a6c9bcfee6a343170ef8c5f69">ushort</a> <a class="el" href="classClient.html#ac6ebab6dbd29d69c58e999ec0273f074">sendTimeout</a> = 5<code> [static, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Default timeout in seconds when sending a message to the server. </p>
<p>In principle the client doesn't need to mess with this, but it's here anyway </p>

<p>Definition at line <a class="el" href="Client_8c_source.html#l00318">318</a> of file <a class="el" href="Client_8c_source.html">Client.c</a>.</p>

</div>
</div>
<a class="anchor" id="a6dee50ddcd3fa9bd16c33ea160d15ae6"></a><!-- doxytag: member="Client::serverAddress" ref="a6dee50ddcd3fa9bd16c33ea160d15ae6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="config_8h.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="el" href="classClient.html#a6dee50ddcd3fa9bd16c33ea160d15ae6">serverAddress</a> = 0x7F000001<code> [static, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Default server IP address in binary (127.1). </p>

<p>Definition at line <a class="el" href="Client_8c_source.html#l00296">296</a> of file <a class="el" href="Client_8c_source.html">Client.c</a>.</p>

</div>
</div>
<a class="anchor" id="ab60a34da8654480c6bba7ac1df2da8c3"></a><!-- doxytag: member="Client::serverAddressStr" ref="ab60a34da8654480c6bba7ac1df2da8c3" args="[50]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char <a class="el" href="classClient.html#ab60a34da8654480c6bba7ac1df2da8c3">serverAddressStr</a>[50] = &quot;127.1&quot;<code> [static, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Default server IP address as string. </p>

<p>Definition at line <a class="el" href="Client_8c_source.html#l00300">300</a> of file <a class="el" href="Client_8c_source.html">Client.c</a>.</p>

</div>
</div>
<a class="anchor" id="ac289967d57409c9bfe8d380f777bca9e"></a><!-- doxytag: member="Client::servicePort" ref="ac289967d57409c9bfe8d380f777bca9e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="config_8h.html#ab95f123a6c9bcfee6a343170ef8c5f69">ushort</a> <a class="el" href="classClient.html#ac289967d57409c9bfe8d380f777bca9e">servicePort</a> = 4000<code> [static, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Default server TCP port. </p>

<p>Definition at line <a class="el" href="Client_8c_source.html#l00304">304</a> of file <a class="el" href="Client_8c_source.html">Client.c</a>.</p>

</div>
</div>
<a class="anchor" id="a7e2c66ccc38864c00befd65cefa28c00"></a><!-- doxytag: member="Client::sourceID" ref="a7e2c66ccc38864c00befd65cefa28c00" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="config_8h.html#a0f128c3e0c83721af0220c00554e9c4e">cchar</a> <a class="el" href="classClient.html#a7e2c66ccc38864c00befd65cefa28c00">sourceID</a>[] = &quot;ZCL&quot;<code> [static, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Identification for the <a class="el" href="classLog.html" title="Log class.">Log</a> file. </p>

<p>Definition at line <a class="el" href="Client_8c_source.html#l00288">288</a> of file <a class="el" href="Client_8c_source.html">Client.c</a>.</p>

</div>
</div>
<a class="anchor" id="ae6e3c294a22e2bdcc8a4893e193ce7d3"></a><!-- doxytag: member="Client::timeoutOccurred" ref="ae6e3c294a22e2bdcc8a4893e193ce7d3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="config_8h.html#a6e2560c92901098cb3cd008a79dcdeba">bool</a> <a class="el" href="classClient.html#ae6e3c294a22e2bdcc8a4893e193ce7d3">timeoutOccurred</a><code> [static, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Tells id there has been a timeout after a receive operations ends in error. </p>

<p>Definition at line <a class="el" href="Client_8c_source.html#l00360">360</a> of file <a class="el" href="Client_8c_source.html">Client.c</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="Client_8c_source.html">Client.c</a></li>
</ul>
</div>
<hr class="footer"/><address style="text-align: right;"><small>Generated on Sat May 8 16:16:37 2010 for TcpClient2 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
